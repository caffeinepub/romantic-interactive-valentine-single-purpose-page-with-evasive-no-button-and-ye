{
  "kind": "build_request",
  "title": "Fix inline celebration photos failing to load",
  "priority": "high",
  "requirements": [
    {
      "id": "REQ-33",
      "text": "Fix the celebration-state inline photo loading so that both static images at `/assets/generated/valentine-photo-1.jpg` and `/assets/generated/valentine-photo-2.jpg` reliably render after clicking YES, instead of showing the fallback text \"Photo could not be loaded\".",
      "target": "frontend",
      "source": {
        "messageIds": [
          "recent-msg-4",
          "recent-msg-6"
        ],
        "quotes": [
          "its saying photo could not be loaded. please fix this immidealty",
          "fix it now"
        ]
      },
      "acceptanceCriteria": [
        "On the YES/celebration state, both photos render inline at the top of the celebration content on desktop and mobile/iPad Safari/Chrome.",
        "The fallback text \"Photo could not be loaded\" does not appear when the assets exist and are reachable.",
        "No backend calls are used to fetch the images; they are loaded as static assets from the frontend."
      ]
    },
    {
      "id": "REQ-34",
      "text": "Harden static asset URL handling for the celebration photos so the image `src` works correctly when the app is served from a non-root base path (e.g., behind a gateway or under a subdirectory), without changing the filenames or the inline layout.",
      "target": "frontend",
      "source": {
        "messageIds": [
          "recent-msg-4"
        ],
        "quotes": [
          "its saying photo could not be loaded. please fix this immidealty"
        ]
      },
      "acceptanceCriteria": [
        "Photo URLs resolve correctly whether the app is served at `/` or under a base path (no 404s for the two photo requests).",
        "The celebration UI remains inline (no fullscreen/lightbox behavior) with the photos stacked vertically above the existing celebration text."
      ]
    },
    {
      "id": "REQ-35",
      "text": "Improve the `CelebrationPhoto` componentâ€™s reliability: ensure it resets its error/loading state when `src` changes, and provide a graceful retry-friendly rendering path so transient decode/load issues do not permanently lock the component into the fallback state.",
      "target": "frontend",
      "source": {
        "messageIds": [
          "recent-msg-4"
        ],
        "quotes": [
          "its saying photo could not be loaded. please fix this immidealty"
        ]
      },
      "acceptanceCriteria": [
        "If the `src` prop changes (or the component remounts), the component attempts to load again instead of staying stuck on the fallback UI.",
        "Successful loads show the image with the existing fade-in behavior and do not regress the current styling/theme."
      ]
    }
  ],
  "constraints": [
    "Do not introduce any fullscreen/lightbox/overlay behavior for the celebration photos; the celebration must render inline in the normal page layout.",
    "Keep all existing celebration copy unchanged (including names and all lines) and keep all user-facing text in English.",
    "Do not fetch images from the backend; use the existing static files under `frontend/public/assets/generated/` with the same filenames.",
    "Do not edit any frontend immutable paths (e.g., `frontend/src/main.tsx`, `frontend/src/hooks/useActor.ts`, `frontend/src/hooks/useInternetIdentity.ts(x)`, or anything under `frontend/src/components/ui`)."
  ],
  "nonGoals": [
    "Adding new images or changing the two existing photo assets.",
    "Changing the evasive NO button behavior or any initial-screen interaction model beyond what is necessary to fix image rendering.",
    "Adding backend logic or persistence (backend remains unused for this fix)."
  ],
  "imageRequirements": {
    "required": [],
    "edits": []
  },
  "userProfileUpdate": {
    "goalsToAdd": [],
    "goalsToRemove": [],
    "preferencesToAdd": [],
    "preferencesToRemove": [],
    "miscToAdd": [],
    "miscToRemove": [],
    "fieldsToSet": {},
    "fieldsToDelete": []
  }
}